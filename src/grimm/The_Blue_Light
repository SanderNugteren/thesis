A soldier has been discharged from the king's service because of his wounds. The soldier leaves the castle and as night falls he requires somewhere to stay. Encountering the cottage of a witch, he asks her for lodging.
She agrees on condition that he spade her garden the next day. This takes so long that he must stay another night, and in return she asks him to chop her wood. Once again, he must stay another night. The following day she requests that he go into a well and retrieve her blue light for her. He is in the process of doing so, but realizes he is being tricked and will be trapped in the well as soon as he gives it to her.
He keeps the light for himself, not knowing what it is, but she leaves him in the well. He decides to smoke one last time and lights his pipe with the blue light. A dwarf comes to grant him whatever he wishes. He first asks to be led out of the well, then for the witch to be taken to jail and hanged.
The soldier is still upset about the king, so he asks that the dwarf bring the princess so he may sleep with her, just to anger the king. When she wakes up, the princess tells her mother of her strange "dream", which the queen believes could have actually happened. She has the princess fill her pocket with peas and put a little hole in it so that if she actually is carried away they will be able to follow the path.
The dwarf, however, notices, and spreads peas all over the city so that the peas lead to everywhere and cannot pin it on the soldier. The next night, she plans on hiding her shoe in the home to which she is taken. The dwarf warns against this to the soldier, but he does not heed it. The next day, the princess's shoe is found in his quarters and he is taken to jail. He sends his friend to get the blue light and as his final request asks for a last smoke of his pipe. The dwarf appears and kills the henchmen; the soldier also demands the king's life, but spares him after he begs for mercy. The soldier marries the princess and takes the throne. . .